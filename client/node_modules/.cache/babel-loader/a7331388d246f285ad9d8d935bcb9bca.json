{"ast":null,"code":"'use strict';\n\nconst moduleConfig = require('../utils/module-config');\n\nconst values = require('pull-stream/sources/values');\n\nconst deferred = require('pull-defer');\n\nconst IsIpfs = require('is-ipfs');\n\nconst cleanCID = require('../utils/clean-cid');\n\nmodule.exports = arg => {\n  const send = moduleConfig(arg);\n  return (args, opts, callback) => {\n    if (typeof opts === 'function') {\n      callback = opts;\n      opts = {};\n    }\n\n    try {\n      args = cleanCID(args);\n    } catch (err) {\n      if (!IsIpfs.ipfsPath(args)) {\n        return callback(err);\n      }\n    }\n\n    const p = deferred.source();\n    send({\n      path: 'ls',\n      args: args,\n      qs: opts\n    }, (err, results) => {\n      if (err) {\n        return callback(err);\n      }\n\n      let result = results.Objects;\n\n      if (!result) {\n        return callback(new Error('expected .Objects in results'));\n      }\n\n      result = result[0];\n\n      if (!result) {\n        return callback(new Error('expected one array in results.Objects'));\n      }\n\n      result = result.Links;\n\n      if (!Array.isArray(result)) {\n        return callback(new Error('expected one array in results.Objects[0].Links'));\n      }\n\n      result = result.map(link => ({\n        depth: 1,\n        name: link.Name,\n        path: args + '/' + link.Name,\n        size: link.Size,\n        hash: link.Hash,\n        type: typeOf(link)\n      }));\n      p.resolve(values(result));\n    });\n    return p;\n  };\n};\n\nfunction typeOf(link) {\n  switch (link.Type) {\n    case 1:\n    case 5:\n      return 'dir';\n\n    case 2:\n      return 'file';\n\n    default:\n      return 'unknown';\n  }\n}","map":{"version":3,"names":["moduleConfig","require","values","deferred","IsIpfs","cleanCID","module","exports","arg","send","args","opts","callback","err","ipfsPath","p","source","path","qs","results","result","Objects","Error","Links","Array","isArray","map","link","depth","name","Name","size","Size","hash","Hash","type","typeOf","resolve","Type"],"sources":["C:/Users/Shreyas/Desktop/DMR-master/client/node_modules/ipfs-http-client/src/files-regular/ls-pull-stream.js"],"sourcesContent":["'use strict'\n\nconst moduleConfig = require('../utils/module-config')\nconst values = require('pull-stream/sources/values')\nconst deferred = require('pull-defer')\nconst IsIpfs = require('is-ipfs')\nconst cleanCID = require('../utils/clean-cid')\n\nmodule.exports = (arg) => {\n  const send = moduleConfig(arg)\n\n  return (args, opts, callback) => {\n    if (typeof (opts) === 'function') {\n      callback = opts\n      opts = {}\n    }\n\n    try {\n      args = cleanCID(args)\n    } catch (err) {\n      if (!IsIpfs.ipfsPath(args)) {\n        return callback(err)\n      }\n    }\n\n    const p = deferred.source()\n\n    send({ path: 'ls', args: args, qs: opts }, (err, results) => {\n      if (err) {\n        return callback(err)\n      }\n\n      let result = results.Objects\n      if (!result) {\n        return callback(new Error('expected .Objects in results'))\n      }\n\n      result = result[0]\n      if (!result) {\n        return callback(new Error('expected one array in results.Objects'))\n      }\n\n      result = result.Links\n      if (!Array.isArray(result)) {\n        return callback(new Error('expected one array in results.Objects[0].Links'))\n      }\n\n      result = result.map((link) => ({\n        depth: 1,\n        name: link.Name,\n        path: args + '/' + link.Name,\n        size: link.Size,\n        hash: link.Hash,\n        type: typeOf(link)\n      }))\n\n      p.resolve(values(result))\n    })\n\n    return p\n  }\n}\n\nfunction typeOf (link) {\n  switch (link.Type) {\n    case 1:\n    case 5:\n      return 'dir'\n    case 2:\n      return 'file'\n    default:\n      return 'unknown'\n  }\n}\n"],"mappings":"AAAA;;AAEA,MAAMA,YAAY,GAAGC,OAAO,CAAC,wBAAD,CAA5B;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,4BAAD,CAAtB;;AACA,MAAME,QAAQ,GAAGF,OAAO,CAAC,YAAD,CAAxB;;AACA,MAAMG,MAAM,GAAGH,OAAO,CAAC,SAAD,CAAtB;;AACA,MAAMI,QAAQ,GAAGJ,OAAO,CAAC,oBAAD,CAAxB;;AAEAK,MAAM,CAACC,OAAP,GAAkBC,GAAD,IAAS;EACxB,MAAMC,IAAI,GAAGT,YAAY,CAACQ,GAAD,CAAzB;EAEA,OAAO,CAACE,IAAD,EAAOC,IAAP,EAAaC,QAAb,KAA0B;IAC/B,IAAI,OAAQD,IAAR,KAAkB,UAAtB,EAAkC;MAChCC,QAAQ,GAAGD,IAAX;MACAA,IAAI,GAAG,EAAP;IACD;;IAED,IAAI;MACFD,IAAI,GAAGL,QAAQ,CAACK,IAAD,CAAf;IACD,CAFD,CAEE,OAAOG,GAAP,EAAY;MACZ,IAAI,CAACT,MAAM,CAACU,QAAP,CAAgBJ,IAAhB,CAAL,EAA4B;QAC1B,OAAOE,QAAQ,CAACC,GAAD,CAAf;MACD;IACF;;IAED,MAAME,CAAC,GAAGZ,QAAQ,CAACa,MAAT,EAAV;IAEAP,IAAI,CAAC;MAAEQ,IAAI,EAAE,IAAR;MAAcP,IAAI,EAAEA,IAApB;MAA0BQ,EAAE,EAAEP;IAA9B,CAAD,EAAuC,CAACE,GAAD,EAAMM,OAAN,KAAkB;MAC3D,IAAIN,GAAJ,EAAS;QACP,OAAOD,QAAQ,CAACC,GAAD,CAAf;MACD;;MAED,IAAIO,MAAM,GAAGD,OAAO,CAACE,OAArB;;MACA,IAAI,CAACD,MAAL,EAAa;QACX,OAAOR,QAAQ,CAAC,IAAIU,KAAJ,CAAU,8BAAV,CAAD,CAAf;MACD;;MAEDF,MAAM,GAAGA,MAAM,CAAC,CAAD,CAAf;;MACA,IAAI,CAACA,MAAL,EAAa;QACX,OAAOR,QAAQ,CAAC,IAAIU,KAAJ,CAAU,uCAAV,CAAD,CAAf;MACD;;MAEDF,MAAM,GAAGA,MAAM,CAACG,KAAhB;;MACA,IAAI,CAACC,KAAK,CAACC,OAAN,CAAcL,MAAd,CAAL,EAA4B;QAC1B,OAAOR,QAAQ,CAAC,IAAIU,KAAJ,CAAU,gDAAV,CAAD,CAAf;MACD;;MAEDF,MAAM,GAAGA,MAAM,CAACM,GAAP,CAAYC,IAAD,KAAW;QAC7BC,KAAK,EAAE,CADsB;QAE7BC,IAAI,EAAEF,IAAI,CAACG,IAFkB;QAG7Bb,IAAI,EAAEP,IAAI,GAAG,GAAP,GAAaiB,IAAI,CAACG,IAHK;QAI7BC,IAAI,EAAEJ,IAAI,CAACK,IAJkB;QAK7BC,IAAI,EAAEN,IAAI,CAACO,IALkB;QAM7BC,IAAI,EAAEC,MAAM,CAACT,IAAD;MANiB,CAAX,CAAX,CAAT;MASAZ,CAAC,CAACsB,OAAF,CAAUnC,MAAM,CAACkB,MAAD,CAAhB;IACD,CA9BG,CAAJ;IAgCA,OAAOL,CAAP;EACD,CAjDD;AAkDD,CArDD;;AAuDA,SAASqB,MAAT,CAAiBT,IAAjB,EAAuB;EACrB,QAAQA,IAAI,CAACW,IAAb;IACE,KAAK,CAAL;IACA,KAAK,CAAL;MACE,OAAO,KAAP;;IACF,KAAK,CAAL;MACE,OAAO,MAAP;;IACF;MACE,OAAO,SAAP;EAPJ;AASD"},"metadata":{},"sourceType":"script"}