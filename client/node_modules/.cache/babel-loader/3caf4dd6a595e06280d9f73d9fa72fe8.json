{"ast":null,"code":"'use strict';\n\nfunction id(e) {\n  return e;\n}\n\nvar prop = require('../util/prop');\n\nmodule.exports = function asyncMap(map) {\n  if (!map) return id;\n  map = prop(map);\n  var busy = false,\n      abortCb,\n      aborted;\n  return function (read) {\n    return function next(abort, cb) {\n      if (aborted) return cb(aborted);\n\n      if (abort) {\n        aborted = abort;\n        if (!busy) read(abort, function (err) {\n          //incase the source has already ended normally,\n          //we should pass our own error.\n          cb(abort);\n        });else read(abort, function (err) {\n          //if we are still busy, wait for the mapper to complete.\n          if (busy) abortCb = cb;else cb(abort);\n        });\n      } else read(null, function (end, data) {\n        if (end) cb(end);else if (aborted) cb(aborted);else {\n          busy = true;\n          map(data, function (err, data) {\n            busy = false;\n\n            if (aborted) {\n              cb(aborted);\n              abortCb && abortCb(aborted);\n            } else if (err) next(err, cb);else cb(null, data);\n          });\n        }\n      });\n    };\n  };\n};","map":{"version":3,"names":["id","e","prop","require","module","exports","asyncMap","map","busy","abortCb","aborted","read","next","abort","cb","err","end","data"],"sources":["C:/Users/Shreyas/Desktop/DREAMS/DMR-master/DREAMS-system/client/node_modules/pull-stream/throughs/async-map.js"],"sourcesContent":["'use strict'\n\nfunction id (e) { return e }\nvar prop = require('../util/prop')\n\nmodule.exports = function asyncMap (map) {\n  if(!map) return id\n  map = prop(map)\n  var busy = false, abortCb, aborted\n  return function (read) {\n    return function next (abort, cb) {\n      if(aborted) return cb(aborted)\n      if(abort) {\n        aborted = abort\n        if(!busy) read(abort, function (err) {\n          //incase the source has already ended normally,\n          //we should pass our own error.\n          cb(abort)\n        })\n        else read(abort, function (err) {\n          //if we are still busy, wait for the mapper to complete.\n          if(busy) abortCb = cb\n          else cb(abort)\n        })\n      }\n      else\n        read(null, function (end, data) {\n          if(end) cb(end)\n          else if(aborted) cb(aborted)\n          else {\n            busy = true\n            map(data, function (err, data) {\n              busy = false\n              if(aborted) {\n                cb(aborted)\n                abortCb && abortCb(aborted)\n              }\n              else if(err) next (err, cb)\n              else cb(null, data)\n            })\n          }\n        })\n    }\n  }\n}\n\n\n\n\n\n\n\n"],"mappings":"AAAA;;AAEA,SAASA,EAAT,CAAaC,CAAb,EAAgB;EAAE,OAAOA,CAAP;AAAU;;AAC5B,IAAIC,IAAI,GAAGC,OAAO,CAAC,cAAD,CAAlB;;AAEAC,MAAM,CAACC,OAAP,GAAiB,SAASC,QAAT,CAAmBC,GAAnB,EAAwB;EACvC,IAAG,CAACA,GAAJ,EAAS,OAAOP,EAAP;EACTO,GAAG,GAAGL,IAAI,CAACK,GAAD,CAAV;EACA,IAAIC,IAAI,GAAG,KAAX;EAAA,IAAkBC,OAAlB;EAAA,IAA2BC,OAA3B;EACA,OAAO,UAAUC,IAAV,EAAgB;IACrB,OAAO,SAASC,IAAT,CAAeC,KAAf,EAAsBC,EAAtB,EAA0B;MAC/B,IAAGJ,OAAH,EAAY,OAAOI,EAAE,CAACJ,OAAD,CAAT;;MACZ,IAAGG,KAAH,EAAU;QACRH,OAAO,GAAGG,KAAV;QACA,IAAG,CAACL,IAAJ,EAAUG,IAAI,CAACE,KAAD,EAAQ,UAAUE,GAAV,EAAe;UACnC;UACA;UACAD,EAAE,CAACD,KAAD,CAAF;QACD,CAJa,CAAJ,CAAV,KAKKF,IAAI,CAACE,KAAD,EAAQ,UAAUE,GAAV,EAAe;UAC9B;UACA,IAAGP,IAAH,EAASC,OAAO,GAAGK,EAAV,CAAT,KACKA,EAAE,CAACD,KAAD,CAAF;QACN,CAJQ,CAAJ;MAKN,CAZD,MAcEF,IAAI,CAAC,IAAD,EAAO,UAAUK,GAAV,EAAeC,IAAf,EAAqB;QAC9B,IAAGD,GAAH,EAAQF,EAAE,CAACE,GAAD,CAAF,CAAR,KACK,IAAGN,OAAH,EAAYI,EAAE,CAACJ,OAAD,CAAF,CAAZ,KACA;UACHF,IAAI,GAAG,IAAP;UACAD,GAAG,CAACU,IAAD,EAAO,UAAUF,GAAV,EAAeE,IAAf,EAAqB;YAC7BT,IAAI,GAAG,KAAP;;YACA,IAAGE,OAAH,EAAY;cACVI,EAAE,CAACJ,OAAD,CAAF;cACAD,OAAO,IAAIA,OAAO,CAACC,OAAD,CAAlB;YACD,CAHD,MAIK,IAAGK,GAAH,EAAQH,IAAI,CAAEG,GAAF,EAAOD,EAAP,CAAJ,CAAR,KACAA,EAAE,CAAC,IAAD,EAAOG,IAAP,CAAF;UACN,CARE,CAAH;QASD;MACF,CAfG,CAAJ;IAgBH,CAhCD;EAiCD,CAlCD;AAmCD,CAvCD"},"metadata":{},"sourceType":"script"}